//----------------------------------------------------------------------------------------------------------------------
#include "CAutoResetMultiEventThread.h"
#include <Framework/Foundation/Console/CConsoleHelper.h>
//----------------------------------------------------------------------------------------------------------------------
namespace CPPFoundation
{
//----------------------------------------------------------------------------------------------------------------------
namespace Testing
{
//----------------------------------------------------------------------------------------------------------------------
	using namespace CPPFoundation::Foundation;
//----------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------
	CAutoResetMultiEventThread::CAutoResetMultiEventThread(CLogWriter& LogWriter, CAutoResetMultiEvent<3>& Event)
		: CThread(LogWriter,"AUTO RESET MULTI EVENT THREAD"), MEvent(Event), MCodeExecuted(false)
	{
	}
//----------------------------------------------------------------------------------------------------------------------
	CAutoResetMultiEventThread::~CAutoResetMultiEventThread(void)
	{
		StopThread();
	}
//----------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------
	void CAutoResetMultiEventThread::ThreadMethod(bool)
	{
		if (HasThreadExiting()==true)
		{
			return;
		}

		if (MCodeExecuted==false)
		{
			MCodeExecuted=true;

			CConsoleHelper::WriteLine("THREAD is RUNNING !");

			Sleep(1000);

			CConsoleHelper::WriteLine("THREAD is SETTING EVENT 1 !");

			MEvent.Set(0);

			Sleep(1000);

			CConsoleHelper::WriteLine("THREAD is SETTING EVENT 2 !");

			MEvent.Set(1);

			Sleep(1000);

			CConsoleHelper::WriteLine("THREAD is SETTING EVENT 3 !");

			MEvent.Set(2);
		}
	}
//----------------------------------------------------------------------------------------------------------------------
	CTimeout CAutoResetMultiEventThread::GetTimeout(void)
	{
		if (MCodeExecuted==false)
		{
			return(CTimeout(0));
		}
		else
		{
			return(CTimeout());
		}
	}
//----------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------
	void CAutoResetMultiEventThread::ThreadSafeUninitializationEvent(void)
	{
		MCodeExecuted=false;
	}
//----------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------
	void CAutoResetMultiEventThread::StartThread(void)
	{
		InternalStartThread();
	}
//----------------------------------------------------------------------------------------------------------------------
	void CAutoResetMultiEventThread::StopThread(void)
	{
		InternalStopThread();
	}
//----------------------------------------------------------------------------------------------------------------------
}
//----------------------------------------------------------------------------------------------------------------------
}
//----------------------------------------------------------------------------------------------------------------------